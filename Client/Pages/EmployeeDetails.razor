@page "/employeedetails/{id}"
@using EmployeeManagement.Shared;

@if (Employee == null || Employee.Department == null)
{
    <div class="d-flex align-center flex-column ma-10">
        <MudProgressCircular Color="Color.Primary" Style="height:70px;width:70px;" Indeterminate="true" />
        <MudText Typo="Typo.subtitle1" Class="mt-4 text-center">Data is loading...</MudText>
    </div>
}
else
{
<MudText Class="ml-12 mb-6" Typo="Typo.h2"><b>@Employee.FirstName @Employee.LastName</b></MudText>
<MudPaper class="py-12">
    <MudGrid>       
        <MudItem xs="4">
            <MudImage Src="@Employee.PhotoPath" Alt="@($"{Employee.FirstName} {Employee.LastName}")" Height="300" class="rounded mx-auto d-block"/>
        </MudItem>
        <MudItem xs="4">  
            <MudSimpleTable class="pb-2" Dense="true" Elevation="0" Outlined="true" >
                <thead>
                    <tr style="border-bottom-style: hidden;" >
                        <td colspan="2"><MudText Typo="Typo.h6">Employee Details</MudText></td>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border-bottom-style: hidden;" >
                        <td><b>Employee ID:</b> </td><td>@Employee.EmployeeId</td>
                    </tr>
                    <tr style="border-bottom-style: hidden;" >
                        <td><b>Department:</b> </td><td>@Employee.Department.DepartmentName</td>
                    </tr>
                    <tr style="border-bottom-style: hidden;" >
                        <td><b>Email:</b> </td><td>@Employee.Email</td>
                    </tr>
                    <tr style="border-bottom-style: hidden;" >
                        <td><b>Date of Birth:</b> </td><td>@Employee.DateOfBirth.ToShortDateString()</td>
                    </tr>
                    <tr style="border-bottom-style: hidden;">  
                        <td><b>Gender:</b> </td><td>@Employee.Gender</td>
                    </tr>
                    <tr>
                        <td><b>Address:</b> </td><td>Street 123</td>
                    </tr>
                </tbody>
            </MudSimpleTable>
        </MudItem>

        <MudItem xs="4">
            <MudStack Row="true">               
                <MudSpacer/>
                <MudIconButton Class="mr-12" Icon="@Icons.Material.Filled.Settings" OnClick="@ToggleOpen" Color="Color.Default" />
                <MudPopover Open="@_isOpen" Fixed="true" Class="px-4 pt-4">
                    <div class="d-flex flex-column">
                        <MudText>Content of the popover can be anything.</MudText>
                        <MudButton OnClick="@ToggleOpen" Class="ml-auto mr-n3 mb-1" Color="Color.Error">Close</MudButton>
                    </div>
                </MudPopover>
            </MudStack>
        </MudItem>
    </MudGrid>
</MudPaper>

}
@code {
    public Employee Employee { get; set; } = new Employee();

    [Inject]
    public IEmployeeService EmployeeService { get; set; }

    [Parameter]
    public string Id { get; set; }

    protected async override Task OnInitializedAsync()
    {
        Id = Id ?? "1";
        Employee = await EmployeeService.GetEmployee(int.Parse(Id));
    }

    public bool _isOpen;

    public void ToggleOpen()
    {
        if (_isOpen)
            _isOpen = false;
        else
            _isOpen = true;
    }
}
